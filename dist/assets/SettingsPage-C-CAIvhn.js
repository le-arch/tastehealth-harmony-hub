import{c as ye,A as Z,r,C as ee,D as te,j as e,P as T,E as se,F as Ne,a as G,G as Ce,H as we,I as Se,B as $,J as S}from"./index-wx0cpdQ-.js";import{C as O,a as A,b as M,c as D,d as L}from"./card-Ks5reE5D.js";import{I as z}from"./input-DlubX1PJ.js";import{S as ke,a as _e,b as Re,c as Pe,d as X}from"./select-Dvj3AB60.js";import{u as Ee}from"./index-Cs8e_-Nm.js";import{u as Te}from"./index-CjjoUzqA.js";import{L as g}from"./label-BLnSVJrc.js";import{R as Fe,a as K}from"./radio-group-Sl-6f1Ib.js";import{T as Ie}from"./textarea-DIE75VUw.js";import{s as x}from"./SupabaseClient-C5AFRzKB.js";import{u as Oe}from"./mobile-DDjMNcjN.js";import{S as Ae,P as Me,d as De,B as Le}from"./ProfileSidebar-CUX9nyIG.js";import{C as $e}from"./chart-pie-Bs8iT_Ce.js";import"./Combination-C0y2sNL0.js";import"./chevron-down-ChOtW655.js";import"./index-DgvYHQCl.js";import"./Logo-HzuToWv5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=ye("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var B="Switch",[Ge,Nt]=Z(B),[Be,qe]=Ge(B),ae=r.forwardRef((a,n)=>{const{__scopeSwitch:s,name:o,checked:i,defaultChecked:d,required:m,disabled:l,value:j="on",onCheckedChange:f,form:v,...y}=a,[b,k]=r.useState(null),_=ee(n,C=>k(C)),N=r.useRef(!1),w=b?v||!!b.closest("form"):!0,[p=!1,h]=te({prop:i,defaultProp:d,onChange:f});return e.jsxs(Be,{scope:s,checked:p,disabled:l,children:[e.jsx(T.button,{type:"button",role:"switch","aria-checked":p,"aria-required":m,"data-state":ne(p),"data-disabled":l?"":void 0,disabled:l,value:j,...y,ref:_,onClick:se(a.onClick,C=>{h(I=>!I),w&&(N.current=C.isPropagationStopped(),N.current||C.stopPropagation())})}),w&&e.jsx(He,{control:b,bubbles:!N.current,name:o,value:j,checked:p,required:m,disabled:l,form:v,style:{transform:"translateX(-100%)"}})]})});ae.displayName=B;var re="SwitchThumb",ie=r.forwardRef((a,n)=>{const{__scopeSwitch:s,...o}=a,i=qe(re,s);return e.jsx(T.span,{"data-state":ne(i.checked),"data-disabled":i.disabled?"":void 0,...o,ref:n})});ie.displayName=re;var He=a=>{const{control:n,checked:s,bubbles:o=!0,...i}=a,d=r.useRef(null),m=Ee(s),l=Ne(n);return r.useEffect(()=>{const j=d.current,f=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(f,"checked").set;if(m!==s&&y){const b=new Event("click",{bubbles:o});y.call(j,s),j.dispatchEvent(b)}},[m,s,o]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...i,tabIndex:-1,ref:d,style:{...a.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ne(a){return a?"checked":"unchecked"}var oe=ae,Ue=ie;const E=r.forwardRef(({className:a,...n},s)=>e.jsx(oe,{className:G("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:s,children:e.jsx(Ue,{className:G("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));E.displayName=oe.displayName;var Ve="Separator",Q="horizontal",Ye=["horizontal","vertical"],ce=r.forwardRef((a,n)=>{const{decorative:s,orientation:o=Q,...i}=a,d=We(o)?o:Q,l=s?{role:"none"}:{"aria-orientation":d==="vertical"?d:void 0,role:"separator"};return e.jsx(T.div,{"data-orientation":d,...l,...i,ref:n})});ce.displayName=Ve;function We(a){return Ye.includes(a)}var le=ce;const F=r.forwardRef(({className:a,orientation:n="horizontal",decorative:s=!0,...o},i)=>e.jsx(le,{ref:i,decorative:s,orientation:n,className:G("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",a),...o}));F.displayName=le.displayName;var q="Collapsible",[Je,Ct]=Z(q),[Xe,H]=Je(q),de=r.forwardRef((a,n)=>{const{__scopeCollapsible:s,open:o,defaultOpen:i,disabled:d,onOpenChange:m,...l}=a,[j=!1,f]=te({prop:o,defaultProp:i,onChange:m});return e.jsx(Xe,{scope:s,disabled:d,contentId:Te(),open:j,onOpenToggle:r.useCallback(()=>f(v=>!v),[f]),children:e.jsx(T.div,{"data-state":V(j),"data-disabled":d?"":void 0,...l,ref:n})})});de.displayName=q;var ue="CollapsibleTrigger",me=r.forwardRef((a,n)=>{const{__scopeCollapsible:s,...o}=a,i=H(ue,s);return e.jsx(T.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":V(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...o,ref:n,onClick:se(a.onClick,i.onOpenToggle)})});me.displayName=ue;var U="CollapsibleContent",he=r.forwardRef((a,n)=>{const{forceMount:s,...o}=a,i=H(U,a.__scopeCollapsible);return e.jsx(Ce,{present:s||i.open,children:({present:d})=>e.jsx(Ke,{...o,ref:n,present:d})})});he.displayName=U;var Ke=r.forwardRef((a,n)=>{const{__scopeCollapsible:s,present:o,children:i,...d}=a,m=H(U,s),[l,j]=r.useState(o),f=r.useRef(null),v=ee(n,f),y=r.useRef(0),b=y.current,k=r.useRef(0),_=k.current,N=m.open||l,w=r.useRef(N),p=r.useRef();return r.useEffect(()=>{const h=requestAnimationFrame(()=>w.current=!1);return()=>cancelAnimationFrame(h)},[]),we(()=>{const h=f.current;if(h){p.current=p.current||{transitionDuration:h.style.transitionDuration,animationName:h.style.animationName},h.style.transitionDuration="0s",h.style.animationName="none";const C=h.getBoundingClientRect();y.current=C.height,k.current=C.width,w.current||(h.style.transitionDuration=p.current.transitionDuration,h.style.animationName=p.current.animationName),j(o)}},[m.open,o]),e.jsx(T.div,{"data-state":V(m.open),"data-disabled":m.disabled?"":void 0,id:m.contentId,hidden:!N,...d,ref:v,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":_?`${_}px`:void 0,...a.style},children:N&&i})});function V(a){return a?"open":"closed"}var Qe=de;const Ze=Qe,et=me,tt=he;function st({rating:a,onRatingChange:n,maxStars:s=5}){const[o,i]=r.useState(0);return e.jsx("div",{className:"flex",children:[...Array(s)].map((d,m)=>{const l=m+1;return e.jsx("button",{type:"button",className:"p-1 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-primary",onClick:()=>n(l),onMouseEnter:()=>i(l),onMouseLeave:()=>i(0),"aria-label":`Rate ${l} out of ${s} stars`,children:e.jsx(Ae,{className:`h-6 w-6 transition-all ${l<=(o||a)?"fill-yellow-400 text-yellow-400":"fill-none text-gray-300 dark:text-gray-600"}`})},l)})})}const wt=()=>{const{theme:a,toggleTheme:n}=Se(),[s,o]=r.useState(null),[i,d]=r.useState(null),[m,l]=r.useState(!0),[j,f]=r.useState(!0),[v,y]=r.useState(!1),[b,k]=r.useState(!1),[_,N]=r.useState(""),[w,p]=r.useState(""),[h,C]=r.useState(""),[I,fe]=r.useState(!1),[P,Y]=r.useState({rating:0,comment:""}),{isMobile:pe,isTablet:rt}=Oe();r.useEffect(()=>{ge(),je()},[]);const ge=async()=>{try{const{data:{user:t}}=await x.auth.getUser();if(!t){l(!1);return}const{data:c,error:u}=await x.from("user_settings").select("*").eq("user_id",t.id).single();u&&u.code!=="PGRST116"&&console.error("Error fetching settings:",u),c?o(c):xe(t.id)}catch(t){console.error("Error in settings fetch:",t)}finally{l(!1)}},xe=async t=>{try{const{data:c,error:u}=await x.from("user_settings").insert({user_id:t,notifications:!0,email_notifications:!0,dark_mode:a==="dark",language:"en",use_metric_system:!0}).select().single();if(u)throw u;o(c)}catch(c){console.error("Error creating default settings:",c)}},je=async()=>{try{const{data:{user:t}}=await x.auth.getUser();if(!t){f(!1);return}const{data:c,error:u}=await x.from("profiles").select("first_name, last_name, dietary_restrictions, allergies, calorie_goal").eq("id",t.id).single();u&&console.error("Error fetching profile:",u),c&&(d(c),N(c.calorie_goal||""),p(c.dietary_restrictions||""),C(c.allergies||""))}catch(t){console.error("Error in profile fetch:",t)}finally{f(!1)}},R=async(t,c)=>{if(s)try{const u={...s,[t]:c};o(u);const{error:J}=await x.from("user_settings").update({[t]:c}).eq("id",s.id);if(J)throw J;(t==="dark_mode"&&a==="light"&&c===!0||t==="dark_mode"&&a==="dark"&&c===!1)&&n()}catch(u){console.error(`Error updating ${t}:`,u),S.error(`Failed to update ${t}`)}},be=async()=>{if(i){y(!0);try{const{data:{user:t}}=await x.auth.getUser();if(!t){S.error("You need to be signed in to update your profile");return}const{error:c}=await x.from("profiles").update({dietary_restrictions:w,allergies:h,calorie_goal:_}).eq("id",t.id);if(c)throw c;S.success("Profile updated successfully!")}catch(t){console.error("Error updating profile:",t),S.error("Failed to update profile")}finally{y(!1)}}},W=(t,c)=>{Y(u=>({...u,[t]:c}))},ve=async()=>{if(P.rating===0){S.error("Please provide a rating");return}k(!0);try{const{data:{user:t}}=await x.auth.getUser();if(!t){S.error("You need to be signed in to submit feedback");return}const{error:c}=await x.from("app_feedback").select("id").limit(1);c&&c.code==="PGRST116"&&await x.rpc("create_app_feedback_table");const{error:u}=await x.from("app_feedback").insert({user_id:t.id,rating:P.rating,comment:P.comment,created_at:new Date().toISOString()});if(u)throw u;S.success("Thank you for your feedback!"),Y({rating:0,comment:""})}catch(t){console.error("Error submitting feedback:",t),S.error("Failed to submit feedback")}finally{k(!1)}};return e.jsxs("div",{className:"flex container space-y-6 py-8 ",children:[e.jsx(Me,{activePage:"settings"}),e.jsxs("div",{className:`flex-1 p-4 sm:p-6 md:p-8 ${pe?"":"md:ml-64"}`,children:[e.jsx("div",{className:"flex items-center justify-between"}),e.jsxs(O,{children:[e.jsxs(A,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5"}),"App Settings"]}),e.jsx(D,{children:"Customize your app experience"})]}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"theme-toggle",className:"font-medium",children:"Dark Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Switch between light and dark themes"})]}),e.jsx(E,{id:"theme-toggle",checked:(s==null?void 0:s.dark_mode)||a==="dark",onCheckedChange:t=>R("dark_mode",t)})]}),e.jsx(F,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"notification-toggle",className:"font-medium",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive app notifications"})]}),e.jsx(E,{id:"notification-toggle",checked:(s==null?void 0:s.notifications)||!1,onCheckedChange:t=>R("notifications",t)})]}),e.jsx(F,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"email-toggle",className:"font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive email updates"})]}),e.jsx(E,{id:"email-toggle",checked:(s==null?void 0:s.email_notifications)||!1,onCheckedChange:t=>R("email_notifications",t)})]}),e.jsx(F,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"unit-system",className:"font-medium",children:"Measurement System"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose your preferred measurement units"})]}),e.jsxs(Fe,{value:s!=null&&s.use_metric_system?"metric":"imperial",onValueChange:t=>R("use_metric_system",t==="metric"),className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{value:"metric",id:"metric"}),e.jsx(g,{htmlFor:"metric",children:"Metric"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{value:"imperial",id:"imperial"}),e.jsx(g,{htmlFor:"imperial",children:"Imperial"})]})]})]}),e.jsx(F,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{htmlFor:"language",className:"font-medium",children:"Language"}),e.jsxs(ke,{value:(s==null?void 0:s.language)||"en",onValueChange:t=>R("language",t),children:[e.jsx(_e,{className:"w-[180px]",children:e.jsx(Re,{placeholder:"Select Language"})}),e.jsxs(Pe,{children:[e.jsx(X,{value:"en",children:"English"}),e.jsx(X,{value:"fr",children:"French"})]})]})]})]})]}),e.jsxs(O,{className:"mt-6",children:[e.jsxs(A,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Nutrition Settings"]}),e.jsx(D,{children:"Customize your nutrition preferences"})]}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{htmlFor:"calorie-goal",children:"Daily Calorie Goal"}),e.jsx(z,{id:"calorie-goal",type:"number",placeholder:"e.g., 2000",value:_,onChange:t=>N(t.target.value)})]}),e.jsxs(Ze,{open:I,onOpenChange:fe,className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Dietary Preferences"}),e.jsx(et,{asChild:!0,children:e.jsxs($,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx("span",{className:"sr-only",children:"Toggle"}),e.jsx(at,{className:"h-4 w-4",open:I})]})})]}),e.jsxs(tt,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{htmlFor:"dietary-restrictions",children:"Dietary Restrictions"}),e.jsx(z,{id:"dietary-restrictions",placeholder:"e.g., Vegetarian, Vegan",value:w,onChange:t=>p(t.target.value)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{htmlFor:"allergies",children:"Allergies"}),e.jsx(z,{id:"allergies",placeholder:"e.g., Nuts, Dairy",value:h,onChange:t=>C(t.target.value)})]})]})]}),e.jsx($,{className:"w-full",onClick:be,disabled:v,children:v?"Saving...":"Save Nutrition Settings"})]})]}),e.jsxs(O,{className:"mt-6",children:[e.jsxs(A,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"Notification Preferences"]}),e.jsx(D,{children:"Manage your notification settings"})]}),e.jsxs(L,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Daily Goal Reminders"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get reminders for your daily nutrition goals"})]}),e.jsx(E,{checked:(s==null?void 0:s.notifications)||!1,onCheckedChange:t=>R("notifications",t)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Weekly Summary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive weekly progress reports"})]}),e.jsx(E,{checked:(s==null?void 0:s.email_notifications)||!1,onCheckedChange:t=>R("email_notifications",t)})]})]})]}),e.jsxs(O,{className:"mt-6",children:[e.jsxs(A,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"App Feedback"]}),e.jsx(D,{children:"Help us improve by sharing your thoughts"})]}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{htmlFor:"rating",className:"font-medium",children:"Rate Your Experience"}),e.jsx("div",{className:"py-2",children:e.jsx(st,{rating:P.rating,onRatingChange:t=>W("rating",t)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{htmlFor:"feedback",className:"font-medium",children:"Your Feedback"}),e.jsx(Ie,{id:"feedback",placeholder:"Tell us what you think about the app...",value:P.comment,onChange:t=>W("comment",t.target.value),rows:4})]}),e.jsx($,{className:"w-full",onClick:ve,disabled:b||P.rating===0,children:b?"Submitting...":"Submit Feedback"})]})]})]})]})},at=({className:a,open:n})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:a,style:{transform:n?"rotate(180deg)":void 0,transition:"transform 0.2s"},children:e.jsx("path",{d:"m6 9 6 6 6-6"})});export{wt as default};
