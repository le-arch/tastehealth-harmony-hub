import{c as I,r as d,j as e,B as u,X as U,b as P,s as A,u as K,d as H}from"./index-wx0cpdQ-.js";import{u as w,A as M}from"./useQuery-fXxgk7Us.js";import{I as V}from"./input-DlubX1PJ.js";import{S as L,a as R,b as q,c as B,d as F}from"./select-Dvj3AB60.js";import{S as p}from"./skeleton-DM5AfKIJ.js";import{g as $,a as G,b as O,c as Q,d as W}from"./mealService-nWoNWhtW.js";import"./SupabaseClient-C5AFRzKB.js";import{S as X}from"./search-C5ZZVUmr.js";import{u as E}from"./mobile-DDjMNcjN.js";import{C as k,a as S,b as C,d as T,c as Y}from"./card-Ks5reE5D.js";import{i as J,a as Z,F as D}from"./FavoriteButton-Dqr0ORzV.js";import{H as _}from"./Combination-C0y2sNL0.js";import{s as ee,C as z}from"./CreateMealPlanDialog--_NKnQ5O.js";import{C as se}from"./chevron-left-CyC_tzUw.js";import{P as ae}from"./plus-Ci3g5hd-.js";import"./index-CjjoUzqA.js";import"./index-Cs8e_-Nm.js";import"./chevron-down-ChOtW655.js";import"./dialog-iH9WTBjz.js";import"./textarea-DIE75VUw.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=I("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),re=({onSelectMeal:r})=>{const[n,m]=d.useState(""),[h,x]=d.useState(""),[c,o]=d.useState(""),{data:t,isLoading:l}=w({queryKey:["mealCategories"],queryFn:$}),{data:i,isLoading:f}=w({queryKey:["mealSubcategories"],queryFn:G}),{data:N,isLoading:y}=w({queryKey:["meals",h,c,n],queryFn:()=>O({category_id:h||void 0,subcategory_id:c||void 0,search:n||void 0})}),v=()=>{m(""),x(""),o("")},g=({mealId:s})=>{const[a,j]=d.useState(null);return d.useEffect(()=>{Q(s).then(j)},[s]),a?e.jsx("img",{src:a,alt:"Meal",className:"w-full h-full object-cover"}):null};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Find Meals"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(V,{placeholder:"Search meals...",value:n,onChange:s=>m(s.target.value),className:"w-full pl-10"}),e.jsx(X,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"})]}),e.jsx("div",{className:"w-full md:w-60",children:l?e.jsx(p,{className:"h-10 w-full"}):e.jsxs(L,{value:h,onValueChange:x,children:[e.jsx(R,{children:e.jsx(q,{placeholder:"All Categories"})}),e.jsxs(B,{children:[e.jsx(F,{value:"all",children:"All Categories"}),t==null?void 0:t.map(s=>e.jsx(F,{value:s.id,children:s.name},s.id))]})]})}),e.jsx("div",{className:"w-full md:w-60",children:f?e.jsx(p,{className:"h-10 w-full"}):e.jsxs(L,{value:c,onValueChange:o,children:[e.jsx(R,{children:e.jsx(q,{placeholder:"All Types"})}),e.jsxs(B,{children:[e.jsx(F,{value:"all",children:"All Types"}),i==null?void 0:i.map(s=>e.jsx(F,{value:s.id,children:s.name},s.id))]})]})}),e.jsxs(u,{variant:"outline",onClick:v,className:"md:w-auto",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Reset"]})]})]}),e.jsx("div",{children:y?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((s,a)=>e.jsx(p,{className:"h-48 w-full rounded-md"},a))}):N&&N.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(s=>e.jsxs("div",{className:"border rounded-md overflow-hidden hover:shadow-md transition-all cursor-pointer",onClick:()=>r(s.id),children:[e.jsxs("div",{className:"h-48 bg-gray-600 relative",children:[s.image_url?e.jsx(g,{mealId:s.id}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-700",children:e.jsx(g,{mealId:s.id})}),e.jsx("div",{className:"absolute bottom-2 right-2  px-2 py-1 text-xs font-medium rounded",children:s.category_name})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-gray-700 truncate dark:text-gray=700",children:s.meal_name}),s.subcategory_name&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:s.subcategory_name})]})]},s.id))}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No meals found. Try adjusting your search."})})})]})},le=({mealId:r,onBack:n,onAddToMealPlan:m,renderFavoriteButton:h})=>{const{data:x,isLoading:c,error:o}=w({queryKey:["meal",r],queryFn:()=>W(r),enabled:!!r}),{isMobile:t,isTablet:l}=E(),[i,f]=d.useState(!1),[N,y]=d.useState(!1);P(),d.useEffect(()=>{(async()=>{if(r){const b=await J(r);f(b)}})()},[r]);const v=async()=>{y(!0);try{await Z(r),f(!0)}catch(j){console.error("Error toggling favorite:",j)}finally{y(!1)}};if(d.useEffect(()=>{o&&console.error("Error fetching meal details:",o)},[o]),c)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"ghost",onClick:n,className:"p-2",children:e.jsx(M,{className:"h-5 w-5"})}),e.jsx(p,{className:"h-8 w-48"})]}),e.jsx(p,{className:"h-64 w-full"}),e.jsx(p,{className:"h-32 w-full"}),e.jsx(p,{className:"h-32 w-full"})]});if(!x)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(u,{onClick:n,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"})," Back to search"]}),e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Meal not found."})})]});const{meal:g,recipe:s,nutritionFacts:a}=x;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(u,{onClick:n,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"})," Back to search"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{onClick:v,variant:"outline",className:`flex items-center gap-2 ${i?"text-red-500 border-red-500 hover:bg-red-50":""}`,disabled:N,children:[e.jsx(_,{className:`h-4 w-4 ${i?"fill-red-500":""}`}),!(t||l)&&(i?"Favorited":"Add to Favorites")]}),m&&e.jsxs(u,{onClick:()=>m(r),variant:"default",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),!(t||l)&&e.jsx("span",{children:"Add to Meal Plan"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:g.meal_name}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("span",{className:"bg-gray-100 px-3 py-1 rounded-full text-sm font-medium text-gray-900 dark:text-gray-900",children:g.category_name}),e.jsx("span",{className:"bg-th-green-100 text-th-green-700 px-3 py-1 rounded-full text-sm font-medium",children:g.subcategory_name})]}),e.jsx("div",{className:"h-48 md:h-64 bg-gray-200 rounded-md overflow-hidden",children:e.jsxs("div",{className:"relative",children:[h&&h(r),e.jsx("img",{src:g.image_url||"/assets/images/achu.jpg",alt:g.meal_name,className:"w-full h-64 object-cover rounded-lg mb-4"})]})})]}),s&&e.jsxs(k,{children:[e.jsx(S,{children:e.jsx(C,{children:"Recipe"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Ingredients"}),s.ingredients&&s.ingredients.length>0?e.jsx("ul",{className:"list-disc pl-5 space-y-1 text-gray-700",children:s.ingredients.map((j,b)=>e.jsxs("li",{className:"text-gray-700 dark:text-gray-100",children:[j.quantity&&`${j.quantity} `,j.quantity]},b))}):e.jsx("p",{className:"text-gray-500",children:"No ingredients listed."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Instructions"}),s.instructions?e.jsx("p",{className:"text-gray-700 dark:text-gray-100 whitespace-pre-line",children:s.instructions}):e.jsx("p",{className:"text-gray-100 dark:text-gray-100",children:"No instructions provided."})]})]})]})]}),e.jsx("div",{children:a&&e.jsxs(k,{children:[e.jsxs(S,{className:"bg-gray-50",children:[e.jsx(C,{className:"text-lg",children:"Nutrition Facts"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Serving Size: ",a.serving_size]})]}),e.jsx(T,{className:"pt-4",children:e.jsx("table",{className:"w-full text-sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 font-bold",children:"Calories"}),e.jsx("td",{className:"py-2 text-right",children:a.calories})]}),e.jsxs("tr",{className:"border-b",children:[e.jsxs("td",{className:"py-2",children:[e.jsx("span",{className:"font-bold",children:"Total Fat"})," ",a.total_fat]}),e.jsx("td",{className:"py-2 text-right",children:a.total_fat})]}),e.jsxs("tr",{className:"border-b pl-4",children:[e.jsx("td",{className:"py-2 pl-4",children:"Saturated Fat"}),e.jsx("td",{className:"py-2 text-right",children:a.saturated_fat})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 pl-4",children:"Trans Fat"}),e.jsx("td",{className:"py-2 text-right",children:a.trans_fat})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"font-bold",children:"Cholesterol"})}),e.jsx("td",{className:"py-2 text-right",children:a.cholesterol})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"font-bold",children:"Sodium"})}),e.jsx("td",{className:"py-2 text-right",children:a.sodium})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"font-bold",children:"Total Carbohydrate"})}),e.jsx("td",{className:"py-2 text-right",children:a.total_carbohydrate})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 pl-4",children:"Dietary Fiber"}),e.jsx("td",{className:"py-2 text-right",children:a.dietary_fiber})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 pl-4",children:"Total Sugars"}),e.jsx("td",{className:"py-2 text-right",children:a.total_sugars})]}),a.added_sugars&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 pl-8",children:"Added Sugars"}),e.jsx("td",{className:"py-2 text-right",children:a.added_sugars})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"font-bold",children:"Protein"})}),e.jsx("td",{className:"py-2 text-right",children:a.protein})]}),a.additional_nutrients&&Object.entries(a.additional_nutrients).map(([j,b])=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:j.replace(/_/g," ")}),e.jsx("td",{className:"py-2 text-right",children:b})]},j))]})})})]})})]})]})};function ie(){const{language:r}=P(),[n,m]=d.useState(null),h={en:{noMealPlans:"No meal plans",getStarted:"Get started by creating a new meal plan.",created:"Created"},fr:{noMealPlans:"Aucun plan de repas",getStarted:"Commencez par créer un nouveau plan de repas.",created:"Créé le"}},x=h[r]||h.en;d.useEffect(()=>{(async()=>{const{data:l}=await A.auth.getUser();l.user&&m(l.user.id)})()},[]);const{data:c,isLoading:o}=w({queryKey:["mealPlans"],queryFn:async()=>{const{data:t,error:l}=await A.from("meal_plans").select("*").order("created_at",{ascending:!1});if(l)throw l;return t},enabled:!!n});return d.useEffect(()=>{(async()=>{if(c&&c.length>0&&n)for(const l of c)await ee(l.id,n)})()},[c,n]),o?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[...Array(3)].map((t,l)=>e.jsx(p,{className:"h-48"},l))}):c!=null&&c.length?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:c.map(t=>e.jsx("div",{className:"w-full",children:e.jsxs(k,{className:"hover:shadow-md transition-shadow text-gray-700 dark:text-gray-100",children:[e.jsxs(S,{children:[e.jsx(C,{children:t.name}),t.description&&e.jsx(Y,{children:t.description})]}),e.jsx(T,{children:e.jsxs("p",{className:"text-sm text-gray-500",children:[x.created," ",new Date(t.created_at).toLocaleDateString(r==="fr"?"fr-FR":"en-US")]})})]})},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(te,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:x.noMealPlans}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:x.getStarted})]})}const Se=()=>{const r=K(),[n,m]=d.useState(null),{toast:h}=H(),{isMobile:x,isTablet:c}=E(),o=x||c,{language:t}=P(),l={en:{back:"Back",mealPlanning:"Meal Planning",favorites:"Favorites",yourMealPlans:"Your Meal Plans",browseMeals:"Browse Meals",addedToFavorites:"Added to favorites",removedFromFavorites:"Removed from favorites",mealAddedToFavorites:"This meal has been added to your favorites",mealRemovedFromFavorites:"This meal has been removed from your favorites"},fr:{back:"Retour",mealPlanning:"Planification des Repas",favorites:"Favoris",yourMealPlans:"Vos Plans de Repas",browseMeals:"Parcourir les Repas",addedToFavorites:"Ajouté aux favoris",removedFromFavorites:"Retiré des favoris",mealAddedToFavorites:"Ce repas a été ajouté à vos favoris",mealRemovedFromFavorites:"Ce repas a été retiré de vos favoris"}},i=l[t]||l.en,f=()=>{r("/dashboard")},N=s=>{m(s)},y=()=>{m(null)},v=s=>{console.log(`Adding meal ${s} to meal plan`),m(null)},g=(s,a)=>{h({title:a?i.addedToFavorites:i.removedFromFavorites,description:a?i.mealAddedToFavorites:i.mealRemovedFromFavorites})};return e.jsxs("div",{className:"container mx-auto p-3 sm:p-4 md:p-6 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(u,{variant:"ghost",className:"mr-2 sm:mr-4",onClick:f,size:o?"icon":"default",children:[e.jsx(se,{className:"h-4 w-4"}),!o&&e.jsx("span",{className:"ml-1",children:i.back})]}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:i.mealPlanning})]}),e.jsx("div",{className:"flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(u,{variant:"outline",size:"icon",className:"rounded-full",onClick:()=>r("/favorites"),children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx(z,{buttonIcon:e.jsx(ae,{className:"h-4 w-4"}),buttonText:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:"outline",className:"flex items-center gap-2",onClick:()=>r("/favorites"),children:[e.jsx(_,{className:"h-4 w-4"}),i.favorites]}),e.jsx(z,{})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4",children:i.yourMealPlans}),e.jsx("div",{className:"card-scroll-container",children:e.jsx("div",{className:"card-scroll-content",children:e.jsx(ie,{})})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4",children:i.browseMeals}),n?e.jsx(k,{className:"overflow-hidden",children:e.jsx(le,{mealId:n,onBack:y,onAddToMealPlan:v,renderFavoriteButton:s=>e.jsx(D,{mealId:s,className:"absolute top-4 right-4 bg-white/80 backdrop-blur-sm shadow-sm z-10",size:24,onToggle:a=>g(s,a)})})}):e.jsx("div",{className:"table-scroll-container",children:e.jsx(re,{onSelectMeal:N,renderFavoriteButton:s=>e.jsx(D,{mealId:s,className:"absolute top-2 right-2 bg-white/80 backdrop-blur-sm shadow-sm",onToggle:a=>g(s,a)})})})]})]})]})};export{Se as default};
